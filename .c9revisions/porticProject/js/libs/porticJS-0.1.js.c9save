{"ts":1355934363698,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1355934571400,"patch":[[{"diffs":[[1,"(function(){\r\n\r\n    /**\r\n\t *@class PorticCtx\r\n\t */\r\n\t// Si existeix, recuperem el context global de portic (1 context per navegador).\r\n\tif('undefined' === typeof window.top.PorticCtx){\r\n\t\tPorticCtx = {};\r\n\t}else{\r\n\t\tPorticCtx = window.top.PorticCtx;\r\n\t}\r\n\t\r\n\tif ('undefined' !== typeof window) {\r\n\t    window.pCtx = window.PorticCtx = pCtx = PorticCtx;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Declaració de les constants de configuració.\r\n\t */\r\n\tvar CONFIG = (function(){\r\n\t\tvar values = {\r\n\t\t   // Resolució de fitxers de literals.\r\n\t\t   'LANGUAGE_BASEPATH': '/PorticMockUp/js/resources/',\r\n\t\t   'LANGUAGE_FILE': 'language_%LANG%.properties',\r\n\t\t   'LANGUAGE_DEFAULT': 'language_en.properties',\r\n\t\t   'LANGUAGE_TOKEN': '%LANG%'\r\n\t\t};\r\n\t    \r\n\t\treturn{\r\n\t\t\tget: function(key) {return values[key];}\r\n\t\t};\r\n\t})();\r\n\t\r\n\t\r\n\tPorticCtx.loadBrowserLanguage = function(){\r\n\t\tPorticCtx.loadLanguage(navigator.language);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Càrrega dels literals a partir del idioma indicat per parámetre.\r\n\t * @method loadLiterals\r\n\t */\r\n\tPorticCtx.loadLanguage = function(psLang){\r\n\t\tvar loResourceToLoad = CONFIG.get('LANGUAGE_BASEPATH');\r\n\t\t\r\n\t\tif('undefined' === typeof psLang){\r\n\t\t\tloResourceToLoad += CONFIG.get('LANGUAGE_DEFAULT');\r\n\t\t}else{\r\n\t\t\tloResourceToLoad += CONFIG.get('LANGUAGE_FILE').replaceAll(CONFIG.get('LANGUAGE_TOKEN'), psLang);\r\n\t\t}\r\n\t\t\r\n\t\t$.ajax({\r\n\t\t    url: loResourceToLoad,\r\n\t\t    async: false,\r\n\t\t    dataType: \"text\",\r\n\t\t    success: function(data, textStatus, jqXHR){Ember.I18n.translations = $.parseJSON(data);},\r\n\t\t    error: ajaxErrorHandler\r\n\t\t});\r\n\t};\r\n\t\r\n\t/**\r\n\t * Recorre tots els elements del formulari indicat, buscant quins corresponen a camps d'entrada i \r\n\t * genera la corresponent cadena JSON. Té en compte possibles arrays d'elements amb el mateix nom.\r\n\t * @param formId valor del camp 'id' del formulari.\r\n\t * @returns cadena JSON.\r\n\t */\r\n\tPorticCtx.formToJSON = function(formId){\r\n\t    var loResult = {};\r\n\t    var loInputs = $(\"#\"+formId).serializeArray();\r\n\t    \r\n\t    $.each(loInputs, function(){\r\n\t    \t\r\n\t        if (loResult[this.name] === undefined) {\r\n\t        \tloResult[this.name] = (this.value || '');\r\n\t        }else{\r\n\t            if (!loResult[this.name].push) {\r\n\t            \tloResult[this.name] = [loResult[this.name]];\r\n\t            }\r\n\t            loResult[this.name].push(this.value || '');\t        \t\r\n\t        }\r\n\t    });\r\n\t    \r\n\t    return JSON.stringify(loResult);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Envía una petició al servidor on les dades s'intercanviaran en format JSON tant de pujada com de baixada.\r\n\t * @param jsonObjectName\r\n\t * @param jsonObjectData\r\n\t * @param url URL on realitzar la petició.\r\n\t * @param callback funció a invocar en cas que la petició finalitzi correctament.\r\n\t * @param errorCallBack funció a invocar en cas que la petició no finalitzi correctament.\r\n\t */\r\n\tPorticCtx.sendJSONPost = function(jsonType, jsonData, url, callback, errorCallBack){\r\n\t\ttry{\r\n\t\t\tvar loErrorCallback = ajaxErrorHandler;\r\n\t\t\t\r\n\t\t\tif('undefined' !== typeof errorCallBack){\r\n\t\t\t\tloErrorCallback = errorCallBack;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t    url: url,\r\n\t\t\t    dataType: \"json\",\r\n\t\t\t    async: false,\r\n\t\t\t    data:  {jsonType : jsonType, jsonData : jsonData},\r\n\t\t\t    success: callback,\r\n\t\t\t    error: loErrorCallback\r\n\t\t\t});\r\n\t\t}catch(e){\r\n\t\t\talert(e.message);\r\n\t\t}\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t * Envía una petició AJAX al servidor.\r\n\t * @param data dades a enviar.\r\n\t * @param url URL on realitzar la petició.\r\n\t * @param callback funció a invocar en cas que la petició finalitzi correctament.\r\n\t * @param errorCallBack funció a invocar en cas que la petició no finalitzi correctament.\r\n\t */\r\n\tPorticCtx.sendAjaxPost = function(data, url, callback, errorCallBack){\r\n\t\ttry{\r\n\t\t\tvar loErrorCallback = ajaxErrorHandler;\r\n\t\t\t\r\n\t\t\tif('undefined' !== typeof errorCallBack){\r\n\t\t\t\tloErrorCallback = errorCallBack;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t    url: url,\r\n\t\t\t    async: false,\r\n\t\t\t    data:  data,\r\n\t\t\t    success: callback,\r\n\t\t\t    error: loErrorCallback\r\n\t\t\t});\r\n\t\t}catch(e){\r\n\t\t\talert(e.message);\r\n\t\t}\r\n\t};\r\n\t\r\n\tajaxErrorHandler = function(data, textStatus, jqXHR){\r\n        alert('Error, error, eee-rror !!!!');\r\n    };\r\n})();\r\n\r\n\r\n\r\n/**\r\n * Afegim al prototip String la funció 'replaceAll'.\r\n **/\r\nString.prototype.replaceAll = function(str1, str2){return this.split(str1).join(str2);};\r\n\r\n/**\r\n * Recupera l'adreça base per a crides http a l'aplicació.\r\n * Parteix de la suposió que les URLs tenen la forma 'http://servername:port/appName/[......]\r\n * @returns {String}\r\n */\r\ngetApplicationPath = function(){\r\n   var href = window.location.href.split('/');\r\n   return href[2];\r\n};"]],"start1":0,"start2":0,"length1":0,"length2":4638}]],"length":4638,"saved":false}
{"ts":1355934924188,"patch":[[{"diffs":[[0,"language);\r\n"],[1,"        console.log('language'+navigator.language);\r\n"],[0,"\t};\r\n\t\r\n\t/**"]],"start1":878,"start2":878,"length1":24,"length2":77}]],"length":4691,"saved":false}
{"ts":1355934964289,"patch":[[{"diffs":[[0,");\r\n"],[-1,"        console.log('language'+navigator.language);\r\n"],[0,"\t};\r"]],"start1":886,"start2":886,"length1":61,"length2":8}]],"length":4638,"saved":false}
{"contributors":[],"silentsave":false,"ts":1355990422423,"patch":[[{"diffs":[[0,": '/"],[-1,"PorticMockUp"],[1,"enchequito/legacycode/workspace/prroutes"],[0,"/js/"]],"start1":536,"start2":536,"length1":20,"length2":48}]],"length":4666,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356047840808,"patch":[[{"diffs":[[0,"\r\n\t};\r\n\t"],[-1,"\r\n\t"],[1,"\t\r\n    PorticCtx.getLiteral = function(key){\r\n    \treturn $.format(Ember.I18n.translations[key]);\r\n\t};\r\n    \r\n    PorticCtx.showError = function(){\r\n    \t$(\"#errorDialog\").show(\"clip\", {}, 1000);\r\n\t};\r\n\t\r\n    "],[0,"ajaxErro"]],"start1":4084,"start2":4084,"length1":19,"length2":225},{"diffs":[[0,");\r\n"],[-1,""],[0,"    };\r\n"],[1,"    \r\n"],[0,"})()"]],"start1":4399,"start2":4399,"length1":16,"length2":22}]],"length":4878,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356737745572,"patch":[[{"diffs":[[0,"ce/p"],[-1,"rroutes"],[1,"orticProject"],[0,"/js/"]],"start1":569,"start2":569,"length1":15,"length2":20}]],"length":4883,"saved":false}
