{"ts":1356021800289,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1356022004747,"patch":[[{"diffs":[[1,"var LogInApp = Ember.Application.create({\r\n    title: 'Mock Up Forwarding',\r\n    ready: function(){\r\n        // Carreguem els literals abans de pintar la página.\r\n    \tPorticCtx.loadBrowserLanguage();\r\n   }\r\n});\r\n\r\nLogInApp.authView = Ember.View.extend({\r\n\t\r\n    // Aquí posarem tot el codi a executar un cop resolta la vista.\r\n    didInsertElement:function(){\r\n    \t$(\"#errorDialog\").hide();\r\n    \t\r\n\t\t// Activem la validació del formulari.\r\n\t\t$(\"#frmAuth\").validate({ \r\n\t\t\trules: {\r\n\t\t\t\tusuari: \"required\",\r\n\t\t\t\tclaupub: {\r\n\t\t\t\t\trequired: true,\r\n\t\t\t\t\tminlength: 6\r\n\t\t\t\t}\t\r\n\t\t\t},\r\n\t\t    messages: {\r\n\t\t\t\tusuari: {\r\n\t\t\t\t\trequired: PorticCtx.getLiteral(\"login.required\"),\r\n\t\t\t\t},\r\n\t\t\t\tclaupub: {\r\n\t\t            required: PorticCtx.getLiteral(\"login.required\"),\r\n\t\t            minlength: PorticCtx.getLiteral(\"login.minLength\")\r\n\t\t        }\r\n\t\t    }\r\n\t\t});\r\n    }\r\n});\r\n\r\nLogInApp.authController = Ember.Object.create({\r\n\tdoAuthenticate: function(event){\r\n\t\tvar loJSON;\r\n\t\t\r\n\t\ttry{\r\n\t\t\tevent.preventDefault();\r\n\t\t\t\r\n\t\t\tloJSON = PorticCtx.formToJSON(\"frmAuth\");\r\n\t\t\t\r\n\t\t\tPorticCtx.sendJSONPost(\"\", loJSON, \"/PorticMockUp/json/rest/autenticate\", response);\r\n\t\t\t\r\n\t\t\tif(pCtx.getSession().ready()){\r\n\t\t\t\t\r\n\t\t\t}else{\r\n\t\t\t\talert(\"No hi ha sessió.\");\r\n\t\t\t}\r\n\t\t}catch(e){\r\n\t\t\talert(e.message);\r\n\t\t}\r\n\t},\r\n\tdoClean: function(event){\r\n\t\t$(\"#frmAuth\")[0].reset();\r\n\t}\r\n\t\r\n});\r\n\r\nLogInApp.errorController = Ember.Object.create({\r\n\tclose: function(event){\r\n\t\t$('#errorDialog').hide('clip', {}, 1000);\t\r\n\t}\r\n});\r\n\r\nfunction response(data){\r\n\tvar loSession = pCtx.getSession();\r\n\t\r\n\ttry{\r\n\t\tloSession.tokenSessio = data.token;\r\n\t\tloSession.usuariSessio = data.usuari;\r\n\t\tloSession.paisSessio = data.pais;\r\n\t\tloSession.nifSessio = data.nif;\r\n\t\tloSession.idioma = data.idioma;\r\n\t}catch(e){\r\n\t\talert(e.message);\r\n\t}\r\n}\r\n\r\n// Cualquier controller/view/...  que se defina deber ir antes de esta línea.\r\nLogInApp.initialize();"]],"start1":0,"start2":0,"length1":0,"length2":1903}]],"length":1903,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356022553309,"patch":[[{"diffs":[[0,"\t\t\t\r\n\t\t\t"],[1,"//"],[0,"PorticCt"]],"start1":1060,"start2":1060,"length1":16,"length2":18}]],"length":1905,"saved":false}
