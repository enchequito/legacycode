{"ts":1356021826767,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1356022030893,"patch":[[{"diffs":[[1,"(function(){\r\n\r\n    /**\r\n\t *@class PorticCtx\r\n\t */\r\n\t// Si existeix, recuperem el context global de portic (1 context per navegador).\r\n\tif('undefined' === typeof window.top.PorticCtx){\r\n\t\tPorticCtx = {};\r\n\t}else{\r\n\t\tPorticCtx = window.top.PorticCtx;\r\n\t}\r\n\t\r\n\tif ('undefined' !== typeof window) {\r\n\t    window.pCtx = window.PorticCtx = pCtx = PorticCtx;\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * 'Singleton' una única sessió per context.\r\n\t */\r\n    function Session(){\r\n    \tthis.tokenSessio = \"\";\r\n    \tthis.usuariSessio = \"\";\r\n    \tthis.paisSessio = \"\";\r\n    \tthis.nifSessio = \"\";\r\n    \tthis.idioma = \"\";\r\n    \tthis.ready = function(){return this.tokenSessio!=\"\";};\r\n     };\r\n     var session = new Session();\r\n\r\n     function GenericForm(){\r\n    \t this.pagina = \"-1\";\r\n    \t this.totalElements = \"\";\r\n    \t this.elementsPagina = \"\";\r\n    \t this.params = \"\";\r\n     };\r\n     GenericForm.prototype = new Session();\r\n    \t\r\n\t/**\r\n\t * Declaració de les constants de configuració.\r\n\t */\r\n\tvar CONFIG = (function(){\r\n\t\tvar values = {\r\n\t\t   // Resolució de fitxers de literals.\r\n\t\t   'LANGUAGE_BASEPATH': '/PorticMockUp/js/resources/',\r\n\t\t   'LANGUAGE_FILE': 'language_%LANG%.properties',\r\n\t\t   'LANGUAGE_DEFAULT': 'language_en.properties',\r\n\t\t   'LANGUAGE_TOKEN': '%LANG%'\r\n\t\t};\r\n\t    \r\n\t\treturn{\r\n\t\t\tget: function(key) {return values[key];}\r\n\t\t};\r\n\t})();\r\n\t\r\n\t/**\r\n\t * Retorna l'objecte sessió carregat en el context.\r\n\t * @returns {Session}\r\n\t */\r\n\tPorticCtx.getSession = function(){return session;};\r\n\t\t\r\n\t/**\r\n\t * Càrrega els literals a partir del el fitxer per defecte.\r\n\t * @method loadLiterals\r\n\t */\r\n\tPorticCtx.loadBrowserLanguage = function(){\r\n\t\tPorticCtx.loadLanguage(navigator.language);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Càrrega dels literals a partir del idioma indicat per parámetre.\r\n\t * Si no s'indica l'idioma, es carrega el fitxer per defecte.\r\n\t * @method loadLiterals\r\n\t */\r\n\tPorticCtx.loadLanguage = function(psLang){\r\n\t\tvar loResourceToLoad = CONFIG.get('LANGUAGE_BASEPATH');\r\n\t\t\r\n\t\tif('undefined' === typeof psLang){\r\n\t\t\tloResourceToLoad += CONFIG.get('LANGUAGE_DEFAULT');\r\n\t\t}else{\r\n\t\t\tloResourceToLoad += CONFIG.get('LANGUAGE_FILE').replaceAll(CONFIG.get('LANGUAGE_TOKEN'), psLang);\r\n\t\t}\r\n\t\t\r\n\t\tthis.sendAjaxPost(\"\", \r\n\t\t\t\t\t\t  loResourceToLoad, \r\n\t\t\t\t\t\t  function(data, textStatus, jqXHR){Ember.I18n.translations = $.parseJSON(data);}, \r\n\t\t\t\t\t\t  ajaxErrorHandler, \r\n\t\t\t\t\t\t  \"text\");\r\n\t};\r\n\t\r\n\t/**\r\n\t * Recorre tots els elements del formulari indicat, buscant quins corresponen a camps d'entrada i \r\n\t * genera la corresponent cadena JSON. Té en compte possibles arrays d'elements amb el mateix nom.\r\n\t * @param formId valor del camp 'id' del formulari.\r\n\t * @returns cadena JSON.\r\n\t */\r\n\tPorticCtx.formToJSON = function(formId){\r\n\t    var loResult = {};\r\n\t    var loInputs = $(\"#\"+formId).serializeArray();\r\n\t    \r\n\t    $.each(loInputs, function(){\r\n\t    \t\r\n\t        if (loResult[this.name] === undefined) {\r\n\t        \tloResult[this.name] = (this.value || '');\r\n\t        }else{\r\n\t            if (!loResult[this.name].push) {\r\n\t            \tloResult[this.name] = [loResult[this.name]];\r\n\t            }\r\n\t            loResult[this.name].push(this.value || '');\t        \t\r\n\t        }\r\n\t    });\r\n\t    \r\n\t    return JSON.stringify(loResult);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Envía una petició al servidor on les dades s'intercanviaran en format JSON tant de pujada com de baixada.\r\n\t * @param jsonType nom complert de la classe de servidor a la que correspón l'objecte JSON enviat. Opcional,\r\n\t * si no s'indica, el servidor mapeja les dades JSON contra una col·lecció de HashMaps.\r\n\t * @param jsonData dades a enviar en format JSON.\r\n\t * @param url URL on realitzar la petició.\r\n\t * @param callback funció a invocar en cas que la petició finalitzi correctament.\r\n\t * @param errorCallBack funció a invocar en cas que la petició no finalitzi correctament. Opcional, si no \r\n\t * s'indica, s'utilitza el gestor d'errors per defecte.\r\n\t */\r\n\tPorticCtx.sendJSONPost = function(jsonType, jsonData, url, callback, errorCallBack){\r\n\t\ttry{\r\n\t\t\tvar data = {jsonType : jsonType, jsonData : jsonData};\r\n\t\t\t\r\n\t\t\tthis.sendAjaxPost(data, url, callback, errorCallBack, \"json\");\r\n\r\n\t\t}catch(e){\r\n\t\t\talert(e.message);\r\n\t\t}\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t * Envía una petició AJAX al servidor.\r\n\t * @param dataToSend dades a enviar.\r\n\t * @param url URL on realitzar la petició.\r\n\t * @param callback funció a invocar en cas que la petició finalitzi correctament.\r\n\t * @param errorCallBack funció a invocar en cas que la petició no finalitzi correctament. Opcional, si no \r\n\t * s'indica, s'utilitza el gestor d'errors per defecte.\r\n\t * @param returnDataType tipus de dades del retorn: text, xml, json, script, html... Opcional, per defecte\r\n\t * 'text' i l'aplicació gestiona el tipus de dades. \r\n\t */\r\n\tPorticCtx.sendAjaxPost = function(dataToSend, url, callback, errorCallBack, returnDataType){\r\n\t\ttry{\r\n\t\t\tvar loErrorCallback = ajaxErrorHandler;\r\n\t\t\tvar lsReturnType = \"text\";\r\n\t\t\t\r\n\t\t\tif('undefined' !== typeof errorCallBack){\r\n\t\t\t\tloErrorCallback = errorCallBack;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif('undefined' !== typeof returnDataType){\r\n\t\t\t\tlsReturnType = returnDataType;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t    url: url,\r\n\t\t\t    dataType: lsReturnType,\r\n\t\t\t    async: false,\r\n\t\t\t    data:  dataToSend,\r\n\t\t\t    success: callback,\r\n\t\t\t    error: loErrorCallback\r\n\t\t\t});\r\n\t\t}catch(e){\r\n\t\t\talert(e.message);\r\n\t\t}\r\n\t};\r\n\t\r\n\tPorticCtx.getLiteral = function(key){\r\n\t\treturn $.format(Ember.I18n.translations[key]);\r\n\t};\r\n\t\r\n\tPorticCtx.showError = function(){\r\n\t\t$(\"#errorDialog\").show(\"clip\", {}, 1000);\r\n\t};\r\n\t\r\n\tajaxErrorHandler = function(data, textStatus, jqXHR){\r\n        alert('Error, error, eee-rror !!!!');\r\n    };\r\n})();\r\n\r\n\r\n\r\n/**\r\n * Afegim al tipus String la funció 'replaceAll'.\r\n **/\r\nString.prototype.replaceAll = function(str1, str2){return this.split(str1).join(str2);};\r\n\r\n/**\r\n * Recupera l'adreça base per a crides http a l'aplicació.\r\n * Parteix de la suposió que les URLs tenen la forma 'http://servername:port/appName/[......]\r\n * @returns {String}\r\n */\r\ngetApplicationPath = function(){\r\n   var href = window.location.href.split('/');\r\n   return href[2];\r\n};"]],"start1":0,"start2":0,"length1":0,"length2":6109}]],"length":6109,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356022234660,"patch":[[{"diffs":[[0,": '/"],[-1,"PorticMockUp"],[1,"enchequito/legacycode/workspace/portic"],[0,"/js/"]],"start1":1076,"start2":1076,"length1":20,"length2":46}]],"length":6135,"saved":false}
{"ts":1356022250166,"patch":[[{"diffs":[[0,"e/portic"],[1,"D"],[0,"/js/reso"]],"start1":1110,"start2":1110,"length1":16,"length2":17}]],"length":6136,"saved":false}
{"ts":1356022274144,"patch":[[{"diffs":[[0,"ace/port"],[-1,"i"],[0,"cD/js/re"]],"start1":1108,"start2":1108,"length1":17,"length2":16}]],"length":6135,"saved":false}
{"ts":1356022771028,"patch":[[{"diffs":[[0,"PATH': '"],[-1,"/"],[0,"enchequi"]],"start1":1071,"start2":1071,"length1":17,"length2":16},{"diffs":[[0,"sources/"],[-1,"'"],[0,",\r\n\t\t   "]],"start1":1123,"start2":1123,"length1":17,"length2":16}]],"length":6133,"saved":false}
{"ts":1356022777068,"patch":[[{"diffs":[[0,"sources/"],[1,"'"],[0,",\r\n\t\t   "]],"start1":1123,"start2":1123,"length1":16,"length2":17}]],"length":6134,"saved":false}
{"ts":1356022816498,"patch":[[{"diffs":[[0,"': '"],[-1,"enchequito/legacycode/workspace/portcD/"],[0,"js/r"]],"start1":1075,"start2":1075,"length1":47,"length2":8}]],"length":6095,"saved":false}
{"ts":1356022840494,"patch":[[{"diffs":[[0,"PATH': '"],[1,"/"],[0,"js/resou"]],"start1":1071,"start2":1071,"length1":16,"length2":17}]],"length":6096,"saved":false}
{"ts":1356022852663,"patch":[[{"diffs":[[0,"PATH': '"],[-1,"/"],[0,"js/resou"]],"start1":1071,"start2":1071,"length1":17,"length2":16}]],"length":6095,"saved":false}
